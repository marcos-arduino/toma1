{% extends 'base.html' %} {% block title %}Testing de Componentes{% endblock %} {% block content %}
<h2>Test</h2>
<div class="row row-cols-1 row-cols-md-6 g-4" id="peliculas"></div>
{% endblock %} {% block scripts %}
<script>
    const API = "http://127.0.0.1:5000/api";

    function crearCard(data) {
        const col = document.createElement("div");
        col.classList.add("col");

        const card = document.createElement("div");
        card.classList.add("card", "text-bg-grey", "mb-3");

        const img = document.createElement("img");
        img.src = data.imageUrl;
        img.classList.add("card-img");
        img.alt = "Imagen de la pelicula";
        card.appendChild(img);

        const overlay = document.createElement("div");
        overlay.classList.add("card-img-overlay");

        const title = document.createElement("h5");
        title.classList.add("card-title");
        title.textContent = data.title;
        overlay.appendChild(title);

        // const text = document.createElement("p");
        // text.classList.add("card-text");
        // text.textContent = data.text;
        // overlay.appendChild(text);

        card.appendChild(overlay);
        col.appendChild(card);

        return col;
    }

    async function cargarPeliculas() {
        console.log("Ejecutando cargarPeliculas()");
        const resp = await fetch(`${API}/peliculas`);
        const json = await resp.json();
        console.log("Respuesta:", json);

        const data = json.data;
        console.log("Data:", data);
        const lista = document.getElementById("peliculas");
        lista.innerHTML = "";
        data.forEach((p) => {
            const nuevaCard = crearCard(p);
            lista.appendChild(nuevaCard);
        });
    }

    window.addEventListener("DOMContentLoaded", cargarPeliculas);
</script>
{% endblock %}
